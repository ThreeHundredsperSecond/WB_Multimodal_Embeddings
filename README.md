# WB_Multimodal_Embeddings
## Проект "Горизонтальный ML"

### Задача

Мультимодальные эмбеддинги - это эмбеддинги, которые построены с использованием информации разных модальностей (например, текст и изображение).

В рамках проекта необходимо на основе изображений и описания/заголовка/характеристик товара построить эмбеддинги, качественно описывающий товар. Качество работы будет определяться через набор прокси-метрик. Для расчета прокси-метрик будут использоваться стандартные метрики: F1, precision, MSE и пр. в зависимости от типа прокси-метрики.

### 1. **Структура Репозитория**
```
WB_Multimodal_Embeddings/
│
├── data/                                         # Директория для хранения данных
│
├── models/                                       # Директория для сохранения обученных моделей
│
├── notebooks/                                    # Jupyter notebooks для исследования и прототипирования
│   ├── main_notebook.ipynb                       # Основной ноутбук
│   └── onnx_notebook.ipynb                       # Ноутбук для работы с ONNX
│
├── src/                                          # Исходный код для пайплайна
│   ├── __init__.py
│   ├── data_preparation.py                       # Скрипт для подготовки данных
│   ├── train_model.py                            # Скрипт для обучения модели
│   ├── generate_embeddings.py                    # Скрипт для получения embeddings
│   ├── compute_metrics.py                        # Скрипт для подсчета метрик
│   ├── onnx/                                     
│   │   ├── convert_to_onnx.py                    # Конвертация моделей в формат ONNX
│   │   └── onnx_generate_embeddings.py           # Генерация вложений в формате ONNX
│   └── metrics_scripts/                          # Скрипты для вычисления метрик
│       ├── compute_metrics_logreg_binary.py      # Метрики для бинарной логистической регрессии
│       ├── compute_metrics_mlp_binary.py         # Метрики для бинарной классификации MLP
│       ├── compute_metrics_mlp_multiclass.py     # Метрики для многоклассовой классификации MLP
│       ├── compute_metrics_multiclass_logreg.py  # Метрики для многоклассовой логистической регрессии
│       ├── prepare_adult_child_dataset.py        # Подготовка датасета "Взрослый/Ребенок"
│       ├── prepare_is_adult_dataset.py           # Подготовка датасета "18+"
│       ├── prepare_male_female_dataset.py        # Подготовка датасета "Мужчина/Женщина"
│       └── prepare_multiclass_dataset.py         # Подготовка датасета для многоклассовой классификации
│
├── requirements.txt                              # Файл с зависимостями
├── .gitignore                                    # Файл для исключения из репозитория
└── README.md                                     # Описание проекта

```


**Прокси-метрики для первого этапа:**

1. **Качество работы классификатора:**

    * Категория
    * Подкатегория
    * Ценовой диапазон
    * Пол (для одежды)
    * Для взрослого/ребёнка (для одежды)
        * Является ли товар товаром исключительно для взрослых

2. **Определение одинаковых товаров с отличающимися изображениями или описанием**



### Данные

1. **Данные для обучения:** изображение, заголовок, описание, характеристики

2. **Данные для валидации:** изображение, заголовок, описание, характеристики, категория, подкатегория, ценовой диапазон


## Табличные данные в формате "parquet"

| Колонка | Описание |
|---|---|
| **nm** | Уникальный идентификатор |
| **title** | Текстовый заголовок товара |
| **description** | Развёрнутое текстовое описание товара |
| **category** | Общая категория товара, выбирается при создании карточки товара человеком |
| **sub_category** | То же, что **category**, но с большим количеством уточнённых классов |
| **isadult** | Булевый флаг: `True` - товар предназначен исключительно для взрослой аудитории (товары для курения, игрушки для секса и пр.), `False` - товар не предназначен исключительно для взрослой аудитории |
| **brend** | Имя бренда производителя товара |


[Логированный эксперимент](https://wandb.ai/wb-project/fine-tuning-ruclip?nw=nwuserchumachenkovladislav)
