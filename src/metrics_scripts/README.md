


##  `compute_metrics_logreg.py` — 
это скрипт для вычисления метрик бинарной классификации с использованием логистической регрессии. Скрипт поддерживает обработку текстовых и изображенных данных, а также их комбинаций и преобразованных через PCA версий. Он предназначен для анализа эффективности различных моделей и подходов в задачах бинарной классификации.


### Аргументы командной строки

Скрипт поддерживает следующие аргументы командной строки:

- `--emb_path` (обязательный): Пути к файлам с эмбеддингами (`.npz`), разделенные пробелом.
- `--tasks` (обязательный): Список имен задач, разделенных пробелом.
- `--df_paths` (обязательный): Список путей к CSV-файлам с данными для каждой задачи, разделенных пробелом. Для каждой задачи пути к файлам должны быть разделены запятыми.
- `--save_path` (обязательный): Путь для сохранения результирующего CSV файла с метриками.
- `--model_names` (обязательный): Список имен моделей, соответствующих файлам эмбеддингов, разделенных пробелом.

### Пример использования

```bash
python compute_metrics_logreg.py --emb_path "path/to/embeddings1.npz path/to/embeddings2.npz" --tasks "task1 task2" --df_paths "path/to/task1_data.csv,path/to/task2_data.csv" --save_path "path/to/results.csv" --model_names "model1 model2"
```

В этом примере скрипт будет обрабатывать эмбеддинги из двух файлов `.npz`, соответствующих двум разным моделям (`model1` и `model2`) и двум задачам (`task1` и `task2`). Для каждой задачи указаны пути к двум CSV-файлам с данными (`path/to/task1_data.csv` для `task1` и `path/to/task2_data.csv` для `task2`). Результаты будут сохранены в файл `path/to/results.csv`.

### Описание работы скрипта

1. **Загрузка данных:** Скрипт загружает эмбеддинги для текста и изображений из указанных `.npz` файлов, а также данные целевой переменной из CSV-файлов.
2. **Обработка данных:** Для каждой задачи данные обрабатываются отдельно, включая возможность применения PCA для сокращения размерности данных.
3. **Вычисление метрик:** С использованием логистической регрессии скрипт вычисляет метрики бинарной классификации (F1-мера, точность, полнота) для каждой комбинации данных (текст, изображение, объединенные, PCA-преобразованные).
4. **Сохранение результатов:** Результаты вычислений сохраняются в указанный CSV-файл.




## `compute_metrics_mlp_binary.py` — 
это скрипт для вычисления метрик (F1, точность, полнота) бинарной классификации с использованием многослойного перцептрона (MLP) 
или на основе предварительно вычисленных эмбеддингов текста и изображений. Скрипт поддерживает работу с различными типами данных,
включая текст, изображения, их комбинации и PCA-преобразованные данные.




### Параметры командной строки

Скрипт поддерживает следующие аргументы командной строки для настройки процесса вычисления метрик:

- `--model_names`: Список имен моделей (например, для различения результатов в выходном файле).
- `--emb_path`: Пути к файлам с эмбеддингами (`.npz`), содержащими эмбеддинги текста (`text`) и изображений (`img`).
- `--tasks`: Список имен задач (используется для метаинформации в выходном файле).
- `--dfs`: Пути к CSV-файлам с данными, где каждый файл должен содержать колонку `target` с метками классов.
- `--save_path`: Путь к файлу, в который будут сохранены результаты вычислений.
- `--average`: Метод усреднения для вычисления метрик (поддерживаются `binary`, `micro`, `macro`, `weighted`).

### Пример использования

```bash
python compute_metrics_mlp_binary.py --model_names model1 model2 --emb_path path/to/embeddings1.npz path/to/embeddings2.npz --tasks Task1 Task2 --dfs path/to/task1_labels.csv path/to/task2_labels.csv --save_path path/to/results.csv --average binary
```   

В этом примере скрипт вычислит метрики для двух задач (`Task1` и `Task2`), используя данные из соответствующих файлов эмбеддингов и меток классов. Результаты будут сохранены в `path/to/results.csv`.

### Описание работы скрипта

1. **Загрузка данных:** Для каждой задачи скрипт загружает соответствующие эмбеддинги текста и изображений из указанных файлов `.npz`, а также метки классов из CSV-файлов.
2. **Обработка данных:** Выполняется нормализация данных, их конкатенация и, при необходимости, применение PCA.
3. **Классификация:** Для каждого типа данных (текст, изображение, комбинация, PCA) выполняется обучение и валидация модели MLPClassifier, вычисляются метрики.
4. **Сохранение результатов:** Результаты вычислений (средние значения F1, точности и полноты) для каждого типа данных сохраняются в указанный файл.






## `compute_metrics_mlp_multiclass.py` — это скрипт для вычисления метрик (F1, точность, полнота) 
мультиклассовой классификации с использованием многослойного перцептрона (MLP). 
Скрипт обрабатывает эмбеддинги текста и изображений, поддерживая работу с текстовыми данными, изображениями,
их комбинациями и PCA-преобразованными данными.



### Параметры командной строки

Скрипт поддерживает следующие аргументы командной строки для настройки процесса вычисления метрик:

- `--model_names`: Список имен моделей (например, для различения результатов в выходном файле).
- `--emb_path`: Пути к файлам с эмбеддингами (`.npz`), содержащими эмбеддинги текста (`text`) и изображений (`img`).
- `--tasks`: Список имен задач (используется для метаинформации в выходном файле).
- `--dfs`: Пути к CSV-файлам с данными, где каждый файл должен содержать колонку `target` с метками классов.
- `--save_path`: Путь к файлу, в который будут сохранены результаты вычислений.
- `--average`: Метод усреднения для вычисления метрик (поддерживаются `micro`, `macro`, `weighted`).

### Пример использования

```bash
python compute_metrics_mlp_multiclass.py --model_names model1 model2 --emb_path path/to/embeddings1.npz path/to/embeddings2.npz --tasks Task1 Task2 --dfs path/to/task1_labels.csv path/to/task2_labels.csv --save_path path/to/results.csv --average weighted
```

В этом примере скрипт вычислит метрики для двух задач (`Task1` и `Task2`), используя данные из соответствующих файлов эмбеддингов и меток классов. Результаты будут сохранены в `path/to/results.csv`.

### Описание работы скрипта

1. **Загрузка данных:** Для каждой задачи скрипт загружает соответствующие эмбеддинги текста и изображений из указанных файлов `.npz`, а также метки классов из CSV-файлов.
2. **Обработка данных:** Выполняется стандартизация данных, их конкатенация и, при необходимости, применение PCA для снижения размерности.
3. **Классификация:** Для каждого типа данных (текст, изображение, комбинация, PCA) выполняется обучение и валидация модели MLPClassifier, вычисляются метрики.
4. **Сохранение результатов:** Результаты вычислений (средние значения F1, точности и полноты) для каждого типа данных сохраняются в указанный файл.


## Важные замечания

- Убедитесь, что все указанные пути к файлам корректны и файлы доступны для чтения.
- Параметр `--average` должен соответствовать задаче классификации: для мультиклассовой классификации обычно используются `micro`, `macro`, или `weighted`; `binary` не подходит для мультиклассовой классификации.
- В зависимости от размера данных и сложности модели процесс обучения может занять значительное время. Убедитесь, что ваше оборудование соответствует требованиям задачи.

Эта документация поможет пользователям эффективно использовать `compute_metrics_mlp_multiclass.py` для вычисления метрик мультиклассовой классификации с MLP, основываясь на предоставленных эмбеддингах текста и изображений.




## `compute_metrics_multiclass_logreg.py` — это скрипт для вычисления метрик мультиклассовой классификации с использованием логистической регрессии. Он предназначен для работы с эмбеддингами текста и изображений, их комбинациями и преобразованными через PCA данными. Скрипт позволяет оценить эффективность различных подходов классификации на множестве категорий.


Убедитесь, что все зависимости установлены в вашем окружении перед запуском скрипта.

### Параметры командной строки

- `--model_names` (обязательно): Список имен моделей.
- `--emb_path` (обязательно): Пути к файлам с эмбеддингами (`.npz`), разделенные пробелами.
- `--tasks` (обязательно): Список имен задач.
- `--dfs` (обязательно): Пути к CSV-файлам с данными для каждой задачи. Каждый файл должен содержать колонку `category` с категориями.
- `--save_path` (обязательно): Путь для сохранения результирующего файла с метриками (CSV).

### Пример использования

```bash
python compute_metrics_multiclass_logreg.py --model_names model1 model2 --emb_path path/to/embeddings1.npz path/to/embeddings2.npz --tasks Task1 Task2 --dfs path/to/task1_labels.csv path/to/task2_labels.csv --save_path path/to/results.csv
```

Этот пример произведет вычисление метрик для двух моделей (`model1` и `model2`) на основе данных, содержащихся в файлах эмбеддингов и меток для двух задач (`Task1` и `Task2`). Результаты будут сохранены в файл `path/to/results.csv`.

### Описание работы скрипта

1. **Загрузка и подготовка данных:** Для каждой задачи скрипт загружает соответствующие эмбеддинги и метки классов. Метки классов кодируются в числовой формат.
2. **Вычисление метрик:** Скрипт обрабатывает текстовые и изображенные данные, их комбинации, а также данные, преобразованные через PCA, для каждой задачи. Для каждого типа данных вычисляются метрики мультиклассовой классификации (F1-мера, точность, полнота) с использованием логистической регрессии.
3. **Сохранение результатов:** Результаты вычислений сохраняются в указанный файл CSV.

## Важные моменты

- Каждый CSV файл с метками должен содержать колонку `category`, которая будет использоваться для кодирования меток.
- Убедитесь, что пути к файлам и имена задач указаны корректно и соответствуют вашим данным.
- Скрипт предполагает, что эмбеддинги для текста и изображений уже предварительно вычислены и сохранены в `.npz` файлах.


