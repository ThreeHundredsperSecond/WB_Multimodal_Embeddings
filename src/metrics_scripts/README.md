


# `compute_metrics_logreg.py` — это скрипт для вычисления метрик бинарной классификации с использованием логистической регрессии. Скрипт поддерживает обработку текстовых и изображенных данных, а также их комбинаций и преобразованных через PCA версий. Он предназначен для анализа эффективности различных моделей и подходов в задачах бинарной классификации.


## Аргументы командной строки

Скрипт поддерживает следующие аргументы командной строки:

- `--emb_path` (обязательный): Пути к файлам с эмбеддингами (`.npz`), разделенные пробелом.
- `--tasks` (обязательный): Список имен задач, разделенных пробелом.
- `--df_paths` (обязательный): Список путей к CSV-файлам с данными для каждой задачи, разделенных пробелом. Для каждой задачи пути к файлам должны быть разделены запятыми.
- `--save_path` (обязательный): Путь для сохранения результирующего CSV файла с метриками.
- `--model_names` (обязательный): Список имен моделей, соответствующих файлам эмбеддингов, разделенных пробелом.

## Пример использования

```bash
python compute_metrics_logreg.py --emb_path "path/to/embeddings1.npz path/to/embeddings2.npz" --tasks "task1 task2" --df_paths "path/to/task1_data.csv,path/to/task2_data.csv" --save_path "path/to/results.csv" --model_names "model1 model2"
```

В этом примере скрипт будет обрабатывать эмбеддинги из двух файлов `.npz`, соответствующих двум разным моделям (`model1` и `model2`) и двум задачам (`task1` и `task2`). Для каждой задачи указаны пути к двум CSV-файлам с данными (`path/to/task1_data.csv` для `task1` и `path/to/task2_data.csv` для `task2`). Результаты будут сохранены в файл `path/to/results.csv`.

## Описание работы скрипта

1. **Загрузка данных:** Скрипт загружает эмбеддинги для текста и изображений из указанных `.npz` файлов, а также данные целевой переменной из CSV-файлов.
2. **Обработка данных:** Для каждой задачи данные обрабатываются отдельно, включая возможность применения PCA для сокращения размерности данных.
3. **Вычисление метрик:** С использованием логистической регрессии скрипт вычисляет метрики бинарной классификации (F1-мера, точность, полнота) для каждой комбинации данных (текст, изображение, объединенные, PCA-преобразованные).
4. **Сохранение результатов:** Результаты вычислений сохраняются в указанный CSV-файл.




# `compute_metrics_mlp_binary.py` — это скрипт для вычисления метрик (F1, точность, полнота) бинарной классификации с использованием многослойного перцептрона (MLP) 
или на основе предварительно вычисленных эмбеддингов текста и изображений. Скрипт поддерживает работу с различными типами данных,
включая текст, изображения, их комбинации и PCA-преобразованные данные.




## Параметры командной строки

Скрипт поддерживает следующие аргументы командной строки для настройки процесса вычисления метрик:

- `--model_names`: Список имен моделей (например, для различения результатов в выходном файле).
- `--emb_path`: Пути к файлам с эмбеддингами (`.npz`), содержащими эмбеддинги текста (`text`) и изображений (`img`).
- `--tasks`: Список имен задач (используется для метаинформации в выходном файле).
- `--dfs`: Пути к CSV-файлам с данными, где каждый файл должен содержать колонку `target` с метками классов.
- `--save_path`: Путь к файлу, в который будут сохранены результаты вычислений.
- `--average`: Метод усреднения для вычисления метрик (поддерживаются `binary`, `micro`, `macro`, `weighted`).

## Пример использования

```bash
python compute_metrics_mlp_binary.py --model_names model1 model2 --emb_path path/to/embeddings1.npz path/to/embeddings2.npz --tasks Task1 Task2 --dfs path/to/task1_labels.csv path/to/task2_labels.csv --save_path path/to/results.csv --average binary
```   

В этом примере скрипт вычислит метрики для двух задач (`Task1` и `Task2`), используя данные из соответствующих файлов эмбеддингов и меток классов. Результаты будут сохранены в `path/to/results.csv`.

## Описание работы скрипта

1. **Загрузка данных:** Для каждой задачи скрипт загружает соответствующие эмбеддинги текста и изображений из указанных файлов `.npz`, а также метки классов из CSV-файлов.
2. **Обработка данных:** Выполняется нормализация данных, их конкатенация и, при необходимости, применение PCA.
3. **Классификация:** Для каждого типа данных (текст, изображение, комбинация, PCA) выполняется обучение и валидация модели MLPClassifier, вычисляются метрики.
4. **Сохранение результатов:** Результаты вычислений (средние значения F1, точности и полноты) для каждого типа данных сохраняются в указанный файл.

